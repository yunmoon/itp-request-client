package xrsa

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestRsaEncrypt(t *testing.T) {
	publicKeyStr := "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtYkswDvtZghPZJEI27ouI2muZpmsr3UJ6tPlW3PyuoUsipW8AC75RDPmiJ+0HX7OTSzefxMZouHw1nVv1J9Fq4cDGF9AyN/7lIrP2gRZ/xnCb7t4t/UsBWa2f4e3MoTcG06w/vRstJTJpSTzei1JLDf6iI4M9wsPxDZIUw/4hjr1dLh6RmyG+zsQNpjjfg51WevGTbCpUBZASflBG+5S2oYYky96mOw/l35dXo7Z8gTU25G7vOjoYPKXo4nAWOcx0nsIFr0SPZjzBRj9T/7YdDV/7JTIL7stUyfjueOV2jkZLM5E/azL/wjr0QN/6PQGR3pKMu13syJ5CAkU+tidUwIDAQAB"
	res, err := RsaEncrypt([]byte("123456"), publicKeyStr)
	t.Logf("加密后字符串：%s", res)
	assert.NoError(t, err)
}

func TestRsaDecrypt(t *testing.T) {
	privateKeyStr := "MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC1iSzAO+1mCE9kkQjbui4jaa5mmayvdQnq0+Vbc/K6hSyKlbwALvlEM+aIn7Qdfs5NLN5/Exmi4fDWdW/Un0WrhwMYX0DI3/uUis/aBFn/GcJvu3i39SwFZrZ/h7cyhNwbTrD+9Gy0lMmlJPN6LUksN/qIjgz3Cw/ENkhTD/iGOvV0uHpGbIb7OxA2mON+DnVZ68ZNsKlQFkBJ+UEb7lLahhiTL3qY7D+Xfl1ejtnyBNTbkbu86Ohg8pejicBY5zHSewgWvRI9mPMFGP1P/th0NX/slMgvuy1TJ+O545XaORkszkT9rMv/COvRA3/o9AZHekoy7XezInkICRT62J1TAgMBAAECggEAG1nJhkUBJYhG/e3kGcbZQLihcA/jNqQ5lEnMmpTDk1qRNWgN5TEumRoAt8DoEDGUv4ftFdQ43pOQB5+186DzjD5RNxDS3/DvJJgtbLmPHaIx60ehjoW/1ih9goVeEpx11R9sB12oKyTnpJwGmvfLuH/OnVhZl7bw7y0GhI05cm+aSpKKf+onnhPJg90R6RWJKrg3rUVvvvEEygAjJjp1HRH4TT/vSkcgW0eLgADoqjCbNwiMoymEIYIQ3LEScN3ci5WJTJ62iMoNm8fHgAB8uykcddZx6y3IPQk+u5WTNra0OyyaJbYN1SNLbWHPeLWp+dO/KKt7kLaSNmJ7eMypoQKBgQDv8WPQH+gKf68HOylxUWDt7OIDBC1sKtNcWgEqmEoz/9rxTnVGARpi1OjhlbuvkT1scSP3W9Ev8EDX33hdxQWtNJmeaxd1tVlnpEGkpCq2eNapSE5Nt5yHi1p2Kapt+r/Rkzb4dS+XhqqN8Ya8dvtQrQgRc+MJKgOZ1D0JW9h5uwKBgQDBry1U/tUupQuNlIsJr582AnGQHwQRbGJfUmoisLY8AgyM3pH0B7Vg3zWjaYH/ajwychvzeDccLfQ3Kh30wPxKI/iew6eakx9IBmzBKVBn/jn7BKWv/dt181Igb5l6hQsrp3dSshH760xb4pEEF8Tj3qP5rojlYOD8oVhdQcPFSQKBgEefq+bVj2OK58llzKIp46BCJNk3pwNx6TPZHh4D5aqOBmIfxHwIGkNEQNwN4T+wQECdqVnOS6xesEyARaLgDCi+2dhjKVaWssBwVLP72VAs1A8mKVGjrJL9cxxwpZI81oONyUvzVyiJJ2JFpa2eariTXiQvjqcOppKFu06O3xi/AoGACygLBW1UXEZ3fuVCiQFLu3Gylumic1p55CG8KVliddxsWqTrZVIYWYch8NLAATVeWE2IXKLdEct32MGdTh7bqW2fAY4lllrJH333P70ge40CS/o9jQCjZozoeyPShGMrfI09606EiK1KDbTkQ4cW+UU2zsgF7KiC7SpiC6UhILkCgYARDrqA02FLa9D5jtBuHxi4UoSUUIM0mygcRSFYXp337+oWitnRZB70Kz1FJkIJKml/J6bJ8murC7QRQqR+ViDCZfI0rGwzWaEf1fsw3FdAazO11TR3xnqhBtyxlq+faWkHhUWXR4Vf60HVro0iLm3GWPf4O0h+XlRsDxp9EZhkKA=="
	res, err := RsaDecrypt("me6d6hGcN9t+Dyk5UUy24vJzlw6sZp533MKKE6sgVBW2MHbTY+1kk72+qKjNG12j6lEymWbBT/4up5JjeuwnjqNXFdQly43+2AlSvpAUcSITN9B/3OCZUreGi4usucVwEb1oSvyD5OhQy4Fq0QGpkvT6w4gaz+eyG7MmfAoaHB/6n8WjzAUos20h5vEefBSMCpK9j4eTWlOcWWNUj6hYVAp02hFE7EthHvDwdJ/kCQKFBsIGlphD2xc7SFrEyfQ8PZZJ9QEca6/QZGQJsVAogd60qTpXolueCsDRch6105BCEl+uEA4+ju/LXqqxQiyOKheNt/Z2+PjslCVQGMFZtg==", privateKeyStr)
	t.Logf("解密后字符串：%s", res)
	assert.NoError(t, err)
}
